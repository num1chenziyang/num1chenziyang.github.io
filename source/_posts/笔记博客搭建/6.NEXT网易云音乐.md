---
title: 6.NEXT网易云音乐
date: 2025-04-05 23:28:27
categories:
  - 笔记博客搭建
tags: 
password:
---

本文章完美解决，下面说一些相关知识
[next主题美化 | 天凉の小站](https://dusk-wind.github.io/2024/08/03/next%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/)

---

# 一.sidebar.njk文件
## 1.作用
**定义侧边栏结构**  
   该文件通过 Nunjucks 模板语法控制侧边栏的模块布局，例如菜单项、近期文章、标签云、分类目录等内容的展示逻辑。

**动态内容生成**  
   支持通过 Hexo 变量动态加载数据，例如：
   • 显示最近发布的文章列表（基于 `site.posts` 数据）；
   • 集成自定义插件（如音乐播放器、时钟等第三方组件）。

**模块化控制**  
   允许开发者通过条件语句（如 `if theme.recent_posts`）按需启用或关闭特定模块，提升灵活性。


## 2.相关文件
**主题配置文件_config.next.yml**
   • **作用**：通过 `custom_file_path` 配置项激活自定义侧边栏文件。例如取消 `sidebar: source/_data/sidebar.njk` 的注释后，主题会加载该文件。
   • **关键配置项**：
```yaml
     custom_file_path:
       sidebar: source/_data/sidebar.njk
```

**样式文件styles.styl**
   • **作用**：控制侧边栏的视觉样式，例如字体、边距、背景色等。通过修改此文件可调整侧边栏的外观。
   • **示例代码**：
```yaml
     .links-of-recent-posts {
       font-size: 0.8em;
       margin-top: 10px;
     }
```

---

# 二.PJAX模块
## 1.介绍
1. **技术基础**  
   PJAX 通过拦截页面链接的点击事件，阻止默认的整页刷新行为，转而通过 Ajax 请求仅加载目标页面的 **指定容器内容**（如文章主体），并利用 `pushState` 更新浏览器 URL 和历史记录。

2. **工作流程**  
   • 用户点击链接 → PJAX 拦截请求 → 发送 Ajax 请求获取局部内容 → 替换容器内的 HTML → 更新 URL 和历史记录。
   • 服务端需返回局部内容（而非完整页面），可通过请求头 `X-PJAX` 识别 PJAX 请求。

3. **优势与局限**  
   • **优势**：减少带宽消耗、加速页面切换、保留动态状态（如播放中的音乐）。
   • **局限**：需处理脚本重载（如数学公式、评论区插件），且对不支持 `pushState` 的旧浏览器不兼容。


## 2.Next 主题中 PJAX 的作用
1. **无缝导航体验**  
   在博客切换文章或页面时，仅刷新主体内容区域（如 `#pjax-container`），而页眉、页脚、侧边栏等静态部分保持不变，减少重复加载资源。

2. **动态内容保留**  
   • 持续播放的背景音乐、动画效果等不会被中断。
   • 支持自定义加载动画（如淡入淡出效果）提升过渡体验。

3. **性能优化**  
   通过缓存历史页面（默认缓存 20 个）和预加载策略（如结合 `quicklink`），进一步加速页面切换。


## 3.Next 主题的 PJAX 配置
1. **启用方法**  
   在 Next 主题的配置文件 `_config.next.yml` 中设置：
   ```yaml
   pjax: true
   ```
   主题会自动加载 PJAX 核心脚本（默认从 CDNJS 获取）。

2. **注意事项**  
   • **图片路径**：需使用 Hexo 的 `asset_img` 标签或绝对路径，避免 PJAX 刷新时图片加载失败。
   • **脚本重载**：需在 PJAX 完成事件（`pjax:complete`）中手动重新初始化动态组件（如数学公式、评论区插件）。
   • **兼容性**：避免与某些插件（如 `fancybox` 和 `mediumzoom`）同时启用，可能引发冲突。

3. **自定义事件示例**  
   ```javascript
   document.addEventListener('pjax:complete', function() {
     // 重新加载数学公式
     MathJax.Hub.Queue(["Typeset", MathJax.Hub, document.querySelector(".post-body")]);
     // 刷新评论区
     if (typeof gitalk !== 'undefined') gitalk.render('gitalk-container');
   });
   ```
此代码可添加到主题的自定义脚本文件中（如 `source/js/custom.js`）。

## 总结
Next 主题的 PJAX 模块通过局部刷新机制显著优化了博客的导航流畅度，但需注意动态内容的重载和兼容性问题。合理配置后，可兼顾速度与功能完整性，适用于内容为主的静态网站（如博客、文档站）。