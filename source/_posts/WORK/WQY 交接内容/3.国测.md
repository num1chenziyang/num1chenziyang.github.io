（主要是：绿色安全版本安装部署）
 
# 一.源头

## 1.绿色版

wqy 将别人的改动 cherry-pick 过来即可使打包。但是打的包不能直接装，为了符合国测要求，wqy 新建 /usr 下 sp-make 目录，将工具和 ids、csdk 打包到一起再送回 tristarm 下。
 
## 2.绿色安全版

wqy 将别人的改动 cherry-pick 过来，此时绿色安全版相较于普通安全版，缺乏很多资源，wqy 将缺失的资源加入了绿色安全版，让安全功能可用。
 
## 3.git 代码路径

maoyongkang/gbase8s_code3，找毛哥问即可
    
# 二.绿色版介绍

绿色版相较于普通版有如下区别：

## 1.编译方面：

普通版依赖 Installanywhere 软件，打出 tar 包，ids_install 也是依赖其生成的，然而国测不允许依赖第三方软件。绿色版即在编译过程中剔除了 Installanywhere 工具，将资源 tar 打包，然后将初始化脚本和资源再次 tar 打包，得出绿色包。
 
## 2.安装方面：

1.普通版安装依靠 ids_install，绿色版依靠 setup.sh（setup.sh 调用的工具开发的 setup.jar 文件进行安装）。  
2.setup.sh 默认是硬加密，需要加密卡；setup.sh -s 是软加密。  
3.安装的时候可能碰见 3 分钟的卡顿时长，此时间是 root 用户想创 dbspace，但是安全版本不允许 root 用户创（会报错 The user is locked，现在可能已经解决），报连接错误后报正常的配置信息，然后安装完成，实例在线。  
4.安装完成后，只允许三全用户连接，sysdaa，sysdba，sysdsa，默认密码是 GBase8s@88，可供参考实例在 2.129:/home/wqy/20240509_END440FIX-R/
    
# 三.绿色版编译

## 1.过程

新建目录/usr/cm/n/b/sp-make  
<1>将 setup.sh 和 setup.jar 放入 /usr/cm/n/b/sp-make。  
<2>编译过程中，将 ids、csdk、jdbc的资源放入/usr/cm/n/b/sp-make/binary 下。  
<3>编译过程中，将 gci 的资源放入了 csdk 的资源中。  
<4>在sp-make 打 tar 包后，放回 tristarm。
 
## 2.xml

wqy 将安装所依赖的三未的 lib 通过 xml 注册进安装包，在执行安装脚本的时候，自动把 sw 的 lib 放入当前环境的 lib 下，以便调用。
 
## 3.远端

code ---> yangliying 拿到 wqy 本地分支的提交，做到了远端（2025 3.26 14:25）  
/usr/cm ---> usercm_for_sp***
 
## 4.命令

sh build.sh all release **SP**
   

note：ids，csdk 均是从 tristarm 下拿到 sp-make 下面，和安装组件打包后放回 tristarm 下，sp-make 下的 ids 和 csdk 资源都会清理（目的是，在 tristarm 下取的包能直接绿色安装，为了符合国测的检查）。