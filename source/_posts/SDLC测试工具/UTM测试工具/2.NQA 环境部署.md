[QA 交接内容](1.NQA-git%20%E7%AE%A1%E7%90%86)
 
# 一.前提条件

## 1.java版本

java -version至少是1.6
 
## 2.git版本

git --version至少是2.0
 
## 3.服务器名

机器名应设为ip地址，否则装不上（不一定，最好机器名是 ip 地址）  
uname -n查看机器名  
hostname 172.16.2.141，此命令暂时修改主机名，重启后主机名还是配置文件里的名。  
vim /etc/hosts，将首行的ip改成本机的ip（改动此文件后需重启服务器）。
    
# 二.UTM环境部署

（##曾经的制作方法，现在不这么做了）  
~~1.~~~~解压工具包~~  
~~tar -xvf tools-utm_env.tar~~  
~~2.~~~~运行脚本，自动部署环境~~  
~~cd tools-utm_env~~  
~~sh run.sh~~  
~~注意，~~~~vim run.sh~~~~，其调用了两个脚本文件，作用是将远端的~~~~UTM~~~~框架拉取到本地，将其涉及用户名密码文件修改为：~~~~http://ci_user:test12345678………………..~~
 
## 1.系统工具检查与重做

（看一下，没有就加上，有就不用做了）

### <1>userid

cp -rp userid/userid-X86_64 /bin/userid  
chmod 6755 /bin/userid  
cp userid/userid-ARM /bin/userid  
chmod 6755 /bin/userid
 
### <2>java

ln -s /usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0.x86_64 /usr/java/jdk1.6.0_20  
（不管前面是java什么版本，此路径不改：/usr/java/jdk1.6.0_20）
 
echo "export JAVA_HOME=/user/java/jdk1.6.0_20; export PATH=\$JAVA_HOME/bin:\$PATH" >>/etc/profile
 
### <3>最大文件开启数量限制

echo "* - nofile 65536" >>/etc/security/limits.conf
 
### <4>git 源码编译安装（若 git 版本小于 2.0）

redhat6.2自带的git1.7版本无法正常使用，需要从源码编译安装git2.0.0。  
安装git依赖的库：curl、zlib、openssl、expat、libiconv  
查看库是否安装：  
rpm qa | grep *curl*  
rpm qa | grep *zlib*  
rpm qa | grep *openssl*  
rpm qa | grep *expat*  
rpm qa | grep *libiconv*  
库资源在172.16.2.141：/home/Packages  
安装.rpm文件命令：￼rpm -ivh xxxxx（很容易碰见各种依赖情况）
 
在141的NQA部署中，git在make all时报hmac.h，将报错处注掉后通过且无影响。  
以上库无需重新安装，redhat6.2自带的库可以支持git2.0.0成功安装。
   

## 2.sh setenv_utm.sh

进入 nqa_make（资源都在172.16.2.151 的/home/wqy/NQA_env_make 下）  
sh setenv_utm.sh：创建 nqa 用户组
   

## 3.制作 /work/workiqa

将 workiqa 工具从 git 上拉下来，创建软链接 /work/workiqa 指向 workiqa（大约 5.9G，有时候根目录大小紧张，就把 workiqa 放到 home 下，然后/work/workiqa 软链接过来）
   

## 4.查看 gettc_install.sh 脚本

位于/work/workiqa/run_git/gettc_install.sh（跟着脚本中的步骤一步一步执行即可）  
<1>做 vobs：clone，权限，软链接  
<2>做/UTM