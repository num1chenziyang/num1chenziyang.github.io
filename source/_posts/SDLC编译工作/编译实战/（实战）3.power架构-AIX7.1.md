---
title: （实战）3.power架构-AIX7.1
date: 2025-04-01 22:49:59
categories:
  - SDLC编译工作
  - 编译实战
tags:
  - 编译
password: 9761565829chen
---
# （前言）机器详情
浪潮-AIX-power机

---

# （一）win外网连接密网某服务器
# 1.笔记本

## 配置静态IPV4，和密网同一网段（172.16.3.58）

如果没有网关无法保存，则在内部设置配置网络，不用写网关。
   

# 2.服务器

## 断开与密网交换机的连接

断开后，管理端网口网线直连笔记本，但是ping不通。  
原因是此项目管理端IP是通过桥接方式实现的，即172.16.3.34是通过172.16.3.36桥接的。
   

# 3.交换机

## 将管理端网线、虚机网线、笔记本网线，连接同一个交换机

外网--->交换机--->AIX服务器与管理端  
将AIX服务器从密网分离出来，通过交换机与外网笔记本连接。
 
这样做的目的是:  
1.断开了与密网的连接，保护密网安全。  
2.管理端通过桥接实现，将其与桥接IP都连接交换机，组成冲突域，这种需要多个IP的情况这样处理。
   

# note：

## 1.冲突域与广播域

**冲突域：**

- ==冲突域指的是一个区域内，如果有两台设备同时发送数据，可能会发生数据碰撞的地方。==
- ==交换机====可以帮助减少冲突域，因为它可以让每个连接的设备形成独立的冲突域，从而减少冲突。==

**广播域：**

- ==广播域是指一个区域内，当一台设备发送广播消息时，所有其他设备都能接收到这个消息。==
- ==路由器====可以帮助分割广播域，因为它可以根据IP地址决定数据包的去向，不会将广播消息传送到另一个网络段。==

==简单来说：==

- ==冲突域关心的是避免数据包碰撞。==
- ==广播域关心的是控制广播消息的传播范围。==
 
## 2.两根网线连接两个交换机（误操作）

- ==现象：密网连接上述交换机的全断。==
- ==广播风暴：如果没有适当的措施来阻止环路，可能会导致广播风暴，使网络性能急剧下降。==
- ==数据包循环：数据包会在环路中无限循环，导致网络拥堵甚至崩溃==

---

# （二）AIX介绍
# 一.AIX介绍

## 1.基础介绍

AIX（Advanced Interactive Executive）高级交互式执行系统，是由IBM开发的一种UNIX操作系统，主要用于IBM的Power Systems服务器以及其他兼容的硬件平台上。AIX提供了强大的功能和稳定性，适用于企业级应用，包括数据库服务、Web应用、科学计算等。
 
==AIX的特点包括但不限于：==

- ==高性能：专为IBM Power架构设计，提供卓越的性能。==
- ==可靠性与可用性：支持高级的故障恢复机制和服务管理工具。==
- ==可扩展性：支持从单处理器到多处理器的系统，易于扩展。==
- ==安全：提供多层次的安全措施，保护敏感数据。==
- ==易管理性：拥有丰富的管理工具，便于系统的监控和维护。==
 
AIX操作系统在金融、电信、政府等领域有着广泛的应用，特别是在那些对系统的稳定性和性能要求极高的环境中。
 
## 2.一些特性

AIX7.2相比于AIX7.1，编译链整个都更新了，所以7.2不能编，必须用7.1
    
## 二.AIX命令详述

## 1.lslpp

lslpp 是AIX操作系统中的一个命令，用于列出系统中已安装的产品和补丁。这个命令可以帮助你了解当前系统中有哪些软件包已经安装，以及它们的版本信息和其他细节。  
1.基本语法  
lslpp [-h] [-V] [-L] [-v] [-c] [-B] [-F] [-G] [-O] [-P] [-S] [-T] [-U] [-X] [-Y] [-Z] [pattern]  
2.常用选项

- -h：显示帮助信息。
- -V：显示产品的版本信息。
- -L：列出所有已安装的产品。
- -v：详细模式，显示产品、版本和级别信息。
- -c：显示已安装的产品的描述。
- -B：只列出已安装的基础产品。
- -F：显示文件集（fileset）的详细信息。
- -G：显示已安装的补丁。
- -O：显示已安装的操作系统产品。
- -P：只列出已安装的补丁。
- -S：只列出已安装的安全补丁。
- -T：显示已安装的第三方产品。
- -U：只列出已安装的更新。
- -X：只列出已安装的可选文件集。
- -Y：只列出已安装的语言支持。
- -Z：只列出已安装的区域支持。

示例

1. 列出所有已安装的产品：￼lslpp -L
2. 列出所有已安装的产品及其版本信息：￼lslpp -VL
3. 列出所有已安装的补丁：￼lslpp -P
4. 列出包含特定字符串的所有已安装产品：￼lslpp -L | grep "java"￼或者直接在 lslpp 命令中加上过滤条件：￼lslpp -L java
5. 列出所有已安装的操作系统产品：￼lslpp -LO
6. 详细模式列出所有已安装的产品：￼lslpp -Lv

---

# （三）编译环境初步配置
# 一.AIX系统命令记录

## 1.常用AIX系统命令

|                                                                |                                                      |
| -------------------------------------------------------------- | ---------------------------------------------------- |
| installp -agYXd . pkaname                                      | 安装软件包                                                |
| installp -aFYXd . pkaname                                      | 强制覆盖已安装的软件包，而没有 -F 选项则只会更新已安装的软件包                    |
| installp -u pkaname                                            | 卸载指定包                                                |
| installp -ug pkaname                                           | 卸载指定包及其依赖包，万万不可随意使用，否则相关的系统工具连带着都被卸载了                |
| loopmount -i Powerha6.1.iso  -o  "-V cdrfs -o ro "    -m  /mnt | 挂载iso文件                                              |
| zcat example.tar.z \| tar -xvf -                               | 解压tar.Z类型文件                                          |
| lslpp -L \| grep xlC*                                          | 查找已经安装的软件                                            |
| yum操作                                                          | [yum基本操作](2.yum%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C) |
    
# 二.iso文件挂载与软件安装

## 1.方法

loopmount -i AIX_v7.1_Install_7100-05-12-2320_flash.iso -o "-V cdrfs -o ro" -m /mnt  
loopmount -i Toolbox_7.1-7.3.iso -o "-V cdrfs -o ro" -m /mnttoolbox
 
/mnttoolbox，配置为yum源。  
/mnt，进入usr/sys/inst.images，通过installp命令安装组件。
 
## 2.资源 #important

资源合集（如gmake、pam等资源）  
[https://www.ibm.com/support/pages/aix-toolbox-open-source-software-downloads-alpha](https://www.ibm.com/support/pages/aix-toolbox-open-source-software-downloads-alpha)
    
# 三.安装xlc工具

## 1.网上的方法（仅参考）

【AIX7.2下安装xlc编译器 - CSDN】[https://blog.csdn.net/aolitianya/article/details/136641388?type=blog&rId=136641388&refer=APP&source=qq_51086008](https://blog.csdn.net/aolitianya/article/details/136641388?type=blog&rId=136641388&refer=APP&source=qq_51086008)  
【AIX 6.1环境 yum的安装方法 - CSDN】[https://blog.csdn.net/wxt_hillwill/article/details/108645707?type=blog&rId=108645707&refer=APP&source=qq_51086008](https://blog.csdn.net/wxt_hillwill/article/details/108645707?type=blog&rId=108645707&refer=APP&source=qq_51086008)
 
## 2.🥬方法（用此方法） #important

1.解压XL_C_Cpp_FOR_AIX_V16.1_EMG.tar.Z，进入usr/sys/inst.images，执行命令installp -agYXd . all  
2.解压16.1.0.5-IBM-xlCcmp-AIX-FP005.tar.Z，执行命令installp -agYXd . all
 
## note：

1.AIX系统中，smitty是一个非常实用的文本用户界面（TUI）工具，用于管理和配置系统。  
2.xlc是IBM XL C/C++ Compiler的命令行工具，它是IBM提供的一款高性能C/C++编译器，专门针对AIX平台进行了优化。在AIX系统上，gbase8s编译使用的就是xlc，而不是gcc。  
3.xlC与AIX系统对应表：https://www.ibm.com/support/pages/aix-os-levels-supported-xl-compilers
    
# 四.源码编译安装

## 1.libuuid

（1）介绍  
libuuid 是一个库，它提供了用于生成和操作 UUID（通用唯一标识符）的函数。UUID 可以用来唯一地标识信息，例如文件系统中的块设备。libuuid 通常作为 util-linux 包的一部分存在。  
（2）编译安装  
下载好源码，./configure，make，make install
 
## 2.pam

本来打算通过源码编译安装，但是编译过程中总是存在问题。后在[资源](3.编译环境初步配置.md)中找到freeradius-pam，使用 rpm 命令安装，成功。
 
## note：

1.编译报错sys/syscall.h no such file or directory  
修改报错文件的：#==include====<==sys/syscall.h==>== ---> #==include== ==<unistd.h>==
 
2.一些执行失败的情况，修改执行权限777 能解决部分问题。

---

# （四）csdk系统问题
# 一.gbasedbt

创建gbasedbt用户；创建gbasedbt用户组，并添加用户
    
# 二.dbautilities.tar

~~/usr/cm下的dbautilities.tar缺失~~~~，从别的服务器取就好~~  
dbautilities.tar 是在 ids 阶段编出来，最后拷贝到/usr/cm 下的  
[dbaccess 与 onversion 问题](7.csdk)
    
# 三.6.00.FC5.AIX_7.2.0.0.tar

改一下 gls 与 csdk 中的脚本，让此文件名统一，能够顺利取到。
    
# 四.编译过程中找不到gmake、git等命令

有时候，会发现gmake、git等命令在脚本中not found，原因是脚本中的PATH与外部环境是不同的，通过echo $PATH输出一下可以看出。此时的解决办法：  
（1）将环境中的PATH都给build/pe_bert脚本的PATH变量。（但是这样是有问题的，在一些小的组件编译的时候，没有调用pe_bert）  
（2）将工具软链接到/usr/bin与/usr/vac/bin下。（因为大部分默认的PATH都有/usr/bin与/usr/vac/bin）

---

# （五）ids系统问题
# 一.找不到系统命令

[编译过程中找不到gmake、git等命令](--csdk)  
包括：xlc、xlc_r、xlC、xlC_r、cc_r、cc  
makeC++SharedLib_r、makeC++SharedLib  
/usr/bin/xlc软链接到which xlc路径  
/usr/vac/bin/xlc软链接到/usr/bin/xlc  
做两套，缺哪做哪。
    
# 二.TOC 大小不足

编译 oninit 的时候出现报错，TOC overflow. TOC size: 76628 Maximum size: 65536  
"TOC overflow" 错误通常表示二进制文件的目录表（TOC）部分超出了最大大小。这通常发生在链接大量目标文件或库时
    
# 三.dbms_random 编译报错

## 1.报错信息：

找不到文件 ieee754.h
 
## 2.说明：

dbms 开头的文件是 package 功能部分，可以暂时不管。可能系统工具升级，导致原有接口是废弃的，即便编出来也不见得好用。
 
## 3.解决方法：

（1）拷贝 ieee754.h 到本系统，将 ieee754.h 调用的其他找不到的头文件删除，将其未定义的类型定义，让其编译通过。  
（2）删除dbms_random功能  
<1>删除 boot1210XC4.sql，dbmsrandom 包头包体。  
<2>删除 blade/excompat/src/Makefile 中，三处dbms_random 相关的内容。
 
note:  
本次编译，加入ieee754.h 后一直有问题，未解决。故将需要调用 ieee754.h 的组件删除，不影响其他功能。若后续需要被删除的 dbms 功能，再加入功能并重做 ieee754.h。
   

# 四.xlC编译的不同之处

AIX 的 cc 即 xlC，通过软链接实现。

## 1.注释处报语法错误

//报错  
<1>修改为/**/注释则通过。  
<2>删除注释则通过。
 
## 2.类型转换报错

possible change of result through conversion of int type into unsigned log int type  
（将 int 类型的数据转换为 unsigned long int 类型时，可能会导致结果的变化。这种警告通常出现在类型不匹配的情况下）  
gcc 在此处没有报错，但是 xlC 是报错的。  
解决方法：加入编译参数-qsuppress=1506-742，忽略此报错。

---

# （六）java工具重做（usrcm）

---

# （七）csdk代码问题
# 一.dbaccess 与 onversion 问题

ids 在编译最后，将 dbautilities.tar 放入 /usr/cm....../aix5L64/4.10.xC4G1/  
csdk 在打包的时候会用到其中的 dbaccess 与 onversion  
倘若这两个组件有问题或者架构都不同，是指向dbautilities.tar 的路径写错  
本次解决方法：修改 build/p-aix5L64.sh 中的 ibmrs6000——64bit 改为aix5L64

---

# （八）ids代码问题
# 一.去除的工具

